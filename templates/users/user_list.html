{% extends "shared/base_list.html" %}

{% block create_url %}{% url 'user_create' %}{% endblock %}

{% block list_item_content %}
    <div class="row w-100 align-items-center">
        <div class="col-12 col-md-8 mb-3 mb-md-0">
            <div class="d-flex align-items-center flex-wrap gap-2">
                <strong>{{ item.full_name }}</strong>

                <div class="d-flex flex-wrap gap-1">
                    {% for role in item.role_badges %}
                        <span class="badge rounded-pill border
                        {% if role.name == 'admin' %}bg-danger-subtle text-danger border-danger-subtle
                        {% elif role.name == 'lecturer' %}bg-success-subtle text-success border-success-subtle
                        {% elif role.name == 'assistant' %}bg-info-subtle text-info border-info-subtle
                        {% else %}bg-primary-subtle text-primary border-primary-subtle{% endif %}"
                              style="font-size: 0.72rem;">
                        {{ role.label }}
                    </span>
                    {% endfor %}
                </div>
            </div>

            <div class="text-muted small mt-1">
                {# student area #}
                {% if item.is_student %}
                    <div class="d-inline-block me-3">
                        <i class="bi bi-mortarboard me-1"></i>
                        {{ item.program|default:"Kein Studiengang" }}
                        {% if item.current_semester %}
                            <span class="text-secondary opacity-50 mx-1">|</span> {{ item.current_semester }}. Semester
                        {% endif %}
                    </div>
                {% endif %}

                {# assistant area #}
                {% if item.is_assistant %}
                    <div class="mt-1">
                        <i class="bi bi-briefcase me-1"></i>
                        <span class="fw-medium">Assistenz für:</span>
                        {% for prog in item.managed_programs_users.all %}
                            <span class="text-dark">{{ prog.name }}</span>{% if not forloop.last %}, {% endif %}
                            {% empty %}
                            <span class="fst-italic">Keine Studiengänge zugewiesen</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>

        {% block list_item_button %}
            <div class="col-12 col-md-4 d-flex justify-content-md-end">
                <div class="btn-group w-100 w-md-auto">
                    {% url 'user_update' item.pk as update_url %}
                    {% include "shared/partials/edit_button.html" with item=item url=update_url %}

                    {% url 'user_delete' item.pk as delete_url %}
                    {% include "shared/partials/delete_button.html" with url=delete_url %}
                </div>
            </div>
        {% endblock %}
    </div>
{% endblock %}